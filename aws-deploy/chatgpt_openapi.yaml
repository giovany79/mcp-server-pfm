openapi: 3.1.0
info:
  title: Personal Finance Manager API
  description: API for accessing personal financial data via AWS Lambda.
  version: 1.0.0
servers:
  - url: https://ys32oben10.execute-api.us-east-1.amazonaws.com/Prod/tools
paths:
  /list_transactions:
    post:
      operationId: listTransactions
      summary: List financial transactions
      description: Retrieves a list of transactions based on filters.
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                limit:
                  type: integer
                  description: Maximum number of transactions to return (use 0 or omit to return all)
                  default: 10
                category:
                  type: string
                  description: Filter by category name
                start_date:
                  type: string
                  format: date
                  description: Start date for filtering (YYYY-MM-DD)
                end_date:
                  type: string
                  format: date
                  description: End date for filtering (YYYY-MM-DD)
                year:
                  type: integer
                  description: Filter by year
                month:
                  type: integer
                  description: Filter by month
                day:
                  type: integer
                  description: Filter by day of month
      responses:
        "200":
          description: Successful response
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    transaction_id:
                      type: string
                    Date:
                      type: string
                    Category:
                      type: string
                    Amount:
                      type: number
                    Income/expensive:
                      type: string
                    Description:
                      type: string

  /calculate_totals:
    post:
      operationId: calculateTotals
      summary: Calculate financial totals
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                year:
                  type: integer
                month:
                  type: integer
                category:
                  type: string
      responses:
        "200":
          description: Successful calculation
          content:
            application/json:
              schema:
                type: object
                properties:
                  income:
                    type: number
                  expenses:
                    type: number
                  balance:
                    type: number
                  transaction_count:
                    type: integer

  /expenses_by_category:
    post:
      operationId: expensesByCategory
      summary: Calculate expenses grouped by category
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                year:
                  type: integer
                  description: Filter by year
                month:
                  type: integer
                  description: Filter by month
      responses:
        "200":
          description: Successful calculation
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    category:
                      type: string
                    total:
                      type: number

  /expenses_by_month_for_category:
    post:
      operationId: expensesByMonthForCategory
      summary: Calculate expenses grouped by month for a category
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                category:
                  type: string
                  description: Category to filter by
                year:
                  type: integer
                  description: Filter by year
      responses:
        "200":
          description: Successful calculation
          content:
            application/json:
              schema:
                type: array
                items:
                  type: object
                  properties:
                    month:
                      type: integer
                    total:
                      type: number

  /add_transaction:
    post:
      operationId: addTransaction
      summary: Add a new transaction
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - description
                - transaction_type
                - amount
                - category
              properties:
                description:
                  type: string
                  description: Transaction description
                transaction_type:
                  type: string
                  description: Transaction type (income or expensive)
                amount:
                  type: number
                  description: Transaction amount (positive number)
                category:
                  type: string
                  description: Category name
                date:
                  type: string
                  format: date
                  description: Transaction date (YYYY-MM-DD)
      responses:
        "200":
          description: Transaction added
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  transaction:
                    type: object
                    properties:
                      transaction_id:
                        type: string
                      Description:
                        type: string
                      Income/expensive:
                        type: string
                      Amount:
                        type: number
                      Category:
                        type: string
                      Date:
                        type: string
                  transaction_count:
                    type: integer

  /update_transaction:
    post:
      operationId: updateTransaction
      summary: Update an existing transaction
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - transaction_id
              properties:
                transaction_id:
                  type: string
                  description: Stable transaction identifier
                description:
                  type: string
                  description: Updated description
                transaction_type:
                  type: string
                  description: Updated transaction type (income or expensive)
                amount:
                  type: number
                  description: Updated amount (positive number)
                category:
                  type: string
                  description: Updated category
                date:
                  type: string
                  format: date
                  description: Updated transaction date (YYYY-MM-DD)
      responses:
        "200":
          description: Transaction updated
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  transaction:
                    type: object
                    properties:
                      transaction_id:
                        type: string
                      Description:
                        type: string
                      Income/expensive:
                        type: string
                      Amount:
                        type: number
                      Category:
                        type: string
                      Date:
                        type: string
                  transaction_count:
                    type: integer

  /delete_transaction:
    post:
      operationId: deleteTransaction
      summary: Delete a transaction
      security:
        - ApiKeyAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - transaction_id
              properties:
                transaction_id:
                  type: string
                  description: Stable transaction identifier
      responses:
        "200":
          description: Transaction deleted
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: string
                  deleted_transaction:
                    type: object
                    properties:
                      transaction_id:
                        type: string
                      Description:
                        type: string
                      Income/expensive:
                        type: string
                      Amount:
                        type: number
                      Category:
                        type: string
                      Date:
                        type: string
                  transaction_count:
                    type: integer
components:
  schemas: {}
  securitySchemes:
    ApiKeyAuth:
      type: apiKey
      in: header
      name: x-api-key
